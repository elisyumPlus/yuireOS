<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Mesai Takip | yuireOS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* Tüm CSS kodların aynı kaldı, sadece admin modal kısmı kaldırıldı */
    /* ... stil kuralların burada ... (önceki mesajdaki gibi) */

    body {
      background: #22232a;
      color: #e5e7eb;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ... Diğer CSS'ler aynı ... */

    .admin-btn-fab {
      position: fixed;
      right: 30px;
      bottom: 30px;
      background: #B10024;
      color: #fff;
      border: none;
      border-radius: 14px;
      width: 130px;
      height: 54px;
      font-size: 1.13rem;
      font-weight: bold;
      box-shadow: 0 3px 18px #B1002466;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s, box-shadow 0.2s;
      z-index: 100;
      outline: none;
      letter-spacing: 0.03em;
    }

    .admin-btn-fab:hover {
      background: #82001A;
      box-shadow: 0 0 18px 6px #B1002466;
    }

    .modal-bg {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: #000a;
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 101;
    }

    .modal {
      background: #232339;
      border-radius: 13px;
      box-shadow: 0 2px 18px #0006;
      padding: 28px 28px 18px 28px;
      width: 320px;
      max-width: 95vw;
      color: #e5e7eb;
      text-align: center;
    }

    .modal label {
      text-align: left;
      font-size: 1rem;
      color: #b3b3c2;
      display: block;
      margin-bottom: 9px;
    }

    .modal input[type="password"] {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: none;
      background: #22232a;
      color: #fff;
      font-size: 1.06rem;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px #2563eb22;
      outline: none;
      transition: box-shadow .2s;
    }

    .modal input[type="password"]:focus {
      box-shadow: 0 0 12px #2563eb99;
    }

    .modal-actions {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .modal-btn {
      background: #2563eb;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 8px 18px;
      font-size: 1rem;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
    }

    .modal-btn.cancel { background: #e24343;}
    .modal-btn.cancel:hover { background: #b91c1c;}
    .modal-btn:hover { background: #1740a1; }
  </style>
</head>
<body>
  <div class="container">
    <span class="brand">yuireOS</span>
    <label for="isim">İsminiz:</label>
    <input type="text" id="isim" placeholder="Adınızı girin"/>
    <div class="actions">
      <button class="btn" onclick="mesaiKaydet('giriş')">Mesai Giriş</button>
      <button class="btn" onclick="mesaiKaydet('çıkış')">Mesai Çıkış</button>
    </div>
    <div class="records" id="records"></div>
    <div class="dashboard" id="dashboard">
      <div class="dashboard-title">Kim Ne Kadar Çalıştı?</div>
      <div id="dashboardRows"></div>
    </div>
    <div class="note">Kayıtlar cihazda saklanır, sayfa yenilense bile kalır.</div>
  </div>

  <!-- Sağ altta Admin Menü tuşu -->
  <button class="admin-btn-fab" onclick="showPasswordModal()" title="Admin Menü">Admin Menü</button>

  <!-- Şifre modalı -->
  <div id="modalBg" class="modal-bg">
    <div class="modal">
      <form id="passwordForm" autocomplete="off">
        <label for="adminPassword">Admin Şifresi:</label>
        <input type="password" id="adminPassword" placeholder="Şifreyi girin" required>
        <div class="modal-actions">
          <button type="button" class="modal-btn cancel" onclick="closePasswordModal()">İptal</button>
          <button type="submit" class="modal-btn">Giriş Yap</button>
        </div>
        <div id="passwordError" style="color:#e24343;margin-top:7px;font-size:0.97rem;display:none"></div>
      </form>
    </div>
  </div>

  <script>
    // === Ana şifre ===
    const ADMIN_PASSWORD = "1234"; // Değiştirilebilir

    // === Kayıt yönetimi ===
    let kayitlar = [];
    if (localStorage.getItem("mesaiKayitlar")) {
      kayitlar = JSON.parse(localStorage.getItem("mesaiKayitlar"));
      kayitlar.forEach(k => { k.dateObj = new Date(k.dateObj); });
    }

    function pad(n) { return n<10 ? '0'+n : n; }
    function tarihSaatObj() {
      const d = new Date();
      return {
        tarih: pad(d.getDate()) + "." + pad(d.getMonth()+1) + "." + d.getFullYear(),
        saat: pad(d.getHours())+":"+pad(d.getMinutes())+":"+pad(d.getSeconds()),
        dateObj: d
      };
    }

    function mesaiKaydet(tip) {
      const isim = document.getElementById("isim").value.trim();
      if (!isim) return alert("Lütfen isminizi giriniz!");
      const ts = tarihSaatObj();
      kayitlar.push({ isim, tip, time: ts.saat, date: ts.tarih, dateObj: ts.dateObj });
      localStorage.setItem("mesaiKayitlar", JSON.stringify(kayitlar));
      guncelleKayitlar();
      guncelleDashboard();
    }

    function guncelleKayitlar() {
      const div = document.getElementById("records");
      if (kayitlar.length === 0) {
        div.innerHTML = '<span style="color:#b3b3c2;">Henüz kayıt yok.</span>';
        return;
      }
      div.innerHTML = kayitlar.map(r =>
        `<div class="record">
          <span class="name">${r.isim}</span>
          <span class="type">${r.tip === 'giriş' ? 'Giriş Yaptı' : 'Çıkış Yaptı'}</span>
          <span class="time">${r.time}</span>
          <span class="date">${r.date}</span>
        </div>`
      ).join('');
    }

    function guncelleDashboard() {
      const div = document.getElementById("dashboardRows");
      const sureler = {};
      kayitlar.forEach(r => {
        if (!sureler[r.isim]) sureler[r.isim] = [];
        sureler[r.isim].push(r);
      });
      let html = '';
      Object.keys(sureler).forEach(isim => {
        let toplamMs = 0;
        let gruplar = sureler[isim];
        for (let i = 0; i < gruplar.length; i++) {
          if (gruplar[i].tip === 'giriş' && gruplar[i+1] && gruplar[i+1].tip === 'çıkış') {
            let giris = gruplar[i].dateObj;
            let cikis = gruplar[i+1].dateObj;
            if (cikis > giris) toplamMs += (cikis - giris);
            i++;
          }
        }
        let min = Math.floor(toplamMs / 60000);
        let h = Math.floor(min / 60);
        let m = min % 60;
        html += `<div class="dashboard-row">
          <span class="dashboard-name">${isim}</span>
          <span class="dashboard-total">${toplamMs > 0 ? (pad(h)+":"+pad(m)) : "--:--"}</span>
        </div>`;
      });
      div.innerHTML = html || '<span style="color:#b3b3c2;">Henüz mesai yok.</span>';
    }

    // === Şifre modalı kontrolü ===
    function showPasswordModal() {
      document.getElementById("adminPassword").value = "";
      document.getElementById("passwordError").style.display = "none";
      document.getElementById("modalBg").style.display = "flex";
      document.getElementById("adminPassword").focus();
    }

    function closePasswordModal() {
      document.getElementById("modalBg").style.display = "none";
    }

    document.getElementById("passwordForm").onsubmit = function(e) {
      e.preventDefault();
      const pw = document.getElementById("adminPassword").value;
      if (pw === ADMIN_PASSWORD) {
        closePasswordModal();
        showAdminModal(); // → yönlendirici hale getirildi
      } else {
        const err = document.getElementById("passwordError");
        err.textContent = "Şifre yanlış!";
        err.style.display = "block";
      }
    };

    // === Yönlendirme fonksiyonu ===
    function showAdminModal() {
      window.location.href = "https://elisyumplus.github.io/yuireOS/admin.html";
    }

    // === Sayfa yüklenince ===
    guncelleKayitlar();
    guncelleDashboard();
  </script>
</body>
</html>
